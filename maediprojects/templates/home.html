{% set active_page='dashboard' %}{% extends "layout.html" %}
{% block title %}{{ _('Dashboard') }}{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-12">
    <h1>{{ _('Dashboard') }}</h1>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <h3>Summary: FY<select class="select" id="select-fy">
      <option value="2014">14</option>
      <option value="2015">15</option>
      <option value="2016">16</option>
      <option value="2017" selected>17</option>
    </select> Disbursements by Sector</h3>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <div id="sectors-pie">
      <p class="lead">Loading data, please wait... <span class="glyphicon glyphicon-refresh loader" aria-hidden="true"></span></p>
    </div>
  </div>
</div>
<script src="{{url_for('static', filename='vendor/d3.v3.min.js')}}" type="text/javascript"></script>
<script src="{{url_for('static', filename='vendor/d3.tip.v0.6.3.js')}}" type="text/javascript"></script>
<script src="{{url_for('static', filename='js/charts/piechart.js')}}" type="text/javascript"></script>
<script type="text/javascript">
  var pieOptions, thisPieChart;
  d3.json("/api/sectors.json", function(error, data) {
    pieOptions = {
      "records": data["sectors"],
      "drilldown": "name",
      "cuts": {
                "fy": "2017"
              }
    }
    thisPieChart = new pieChart("#sectors-pie", pieOptions);
  });
  $(document).on("click", "#select-fy", function(){
    var year = $(this).val();
    console.log(year)
    pieOptions["cuts"]["fy"] = year;
    thisPieChart.setData(pieOptions);
  });
</script>

{% endblock %}
