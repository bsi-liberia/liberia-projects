sudo: false
language: python
cache: pip
python:
  - 2.7
addons:
  apt:
    sources:
      - google-chrome
    packages:
      - google-chrome-stable
env:
  - FLASK_ENV=development
before_install:
  - whereis google-chrome-stable
  - google-chrome-stable --version
  - mkdir /tmp/chromedriver
  - wget https://chromedriver.storage.googleapis.com/73.0.3683.68/chromedriver_linux64.zip -O /tmp/chromedriver/chromedriver.zip
  - unzip /tmp/chromedriver/chromedriver.zip -d /tmp/chromedriver
  - chmod 700 /tmp/chromedriver/chromedriver
  - google-chrome-stable --headless --disable-gpu --no-sandbox --remote-debugging-port=9222 http://localhost &
install:
  - pip install -r requirements_dev.txt
script:
  - pytest --driver Chrome --driver-path /tmp/chromedriver/chromedriver
